# OpenTSR Compliance Requirements

**Version:** 1.0.0-draft
**Status:** ENFORCED
**Authority:** TKOResearch LLC / OpenTSR Maintainers

## 1. Overview
To ensure high-assurance safety for Agentic AI, all OpenTSR implementations must adhere to strict data fidelity and verification standards. This document defines the "Must-Haves" for a signal to be valid.

## 2. Telemetry Requirements

### 2.1. Temporal Precision
* **Nanosecond Resolution:** All timestamps (`tsr_timestamp_ns`) MUST be 64-bit integers representing nanoseconds since the Unix Epoch. Millisecond precision is insufficient for high-frequency trading or chemical reaction monitoring.
* **Time Source:** Agents SHOULD synchronize with an NTP stratum-2 source or better.

### 2.2. Identity & Origin
* **UUIDv7:** The `tsr_id` MUST be a UUIDv7 (time-ordered). Random UUIDv4 is PROHIBITED to ensure database index locality.
* **Agent Identity:** If the signal is generated by an LLM Agent, the `agent_id` field MUST be present and cryptographically verifiable (if signed).
* **Action Intent:** If the signal is generated by an LLM Agent, `action_intent` MUST be present.

### 2.3. Vector Embeddings
* **Dimensionality:** The `vector` array SHOULD default to **1536 dimensions** (OpenAI `text-embedding-3-small` compatible) or **1024 dimensions** (NVIDIA NeMo compatible).
* **Normalization:** All vectors MUST be normalized to unit length (L2 norm) to allow for immediate Cosine Similarity search.

## 3. Veracity & Safety Protocol

### 3.1. The "Veracity" Score
* Every signal packet MUST include a `safety.veracity_score` float between `0.0` and `1.0`.
* Every signal packet MUST include `safety.hazard_flag` (`true` or `false`).
    * `1.0`: Hardware-confirmed signal (e.g., TPM-signed sensor).
    * `0.5`: Inferenced signal (e.g., LLM observation).
    * `0.1`: Unverified simulation / Synthetic data.

### 3.2. Cryptographic Integrity
* **High-Assurance Mode:** In production environments (`env=prod`), the payload MUST be signed. The signature MUST be stored in `safety.digital_signature`.
* **Algorithm Annotation:** Signed payloads MUST include `safety.signature_alg`.

## 4. Operational Constraints

### 4.1. Payload Size
* **Maximum Packet Size:** 1MB (Soft Limit), 5MB (Hard Limit).
* **Blob Data:** Large binary objects (images, PCAP files) MUST NOT be embedded in the JSON. They MUST be stored in R2/S3, and the `payload` MUST contain the `blob_url` and `sha256_hash`.
* **Physical Sensor Vocabulary:** Physical telemetry SHOULD use `payload.physical:sensor` as defined in `spec/vocabulary.md`.

### 4.2. Schema Validation
* All emitters MUST validate against `spec/schema.json` before transmission.
* Invalid packets will be dropped by the TARE Ingestion Engine with a `400 Bad Request` error.

---
**Verification:**
Run `pytest --compliance-check` to verify your implementation against these requirements.
